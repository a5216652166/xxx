<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta content="睿江云,云主机,云服务器,BGP多线,IPLC,国际带宽" name="keywords">
    <meta content="提供云主机租赁服务，BGP多线带宽接入服务，IPLC国际互联带宽接入。广东睿江科技有限公司是国内领先的IDC数据中心服务提供商，拥有雄厚的资源力量和技术力量，并在此基础上提供完备的虚拟化云主机服务，致力于打造一个智慧的可持续发展的云数据中心生态系统" name="description">
    <meta content="睿江科技 研发项目组" name="author">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <include file="Public:common"/>
    <script type="text/javascript" src="__ROOT__/Public/js/jquery.js"></script>
    
	</head>
    
  <body class="page_buy">
  
    <!-- Static navbar -->
    <include file="Public:head"/>

    <div class="container">
    <input type="hidden" id="price_total" value="145">
    <input type="hidden" id="price_num" value="1">
    <input type="hidden" id="price_term" value="1">

    <div id="config" class="container">
        请选择配置
        <hr>
    </div>
    <div class="mt20 clearfix">
        <div class="col-md-1 title">
            机房:
        </div>
        <div class="col-md-9" style="width:65%">
	    <div id="house" class="clearfix">
        <volist name="houseList" id="item">
        	<if condition="$i == 1">
				<div class="house-button"><button class="option cpu btn btn-default btn-info" style="width:160px;" mem-list="512,1,2,4" data="{$item.StockHouseName}"><i class="fa fa-check-circle-o"></i>{$item.StockHouseName}</button></div>
                <else/>                
				<div class="house-button"><button class="option cpu btn btn-default" style="width:160px;" mem-list="2,4,8" data="{$item.StockHouseName}">{$item.StockHouseName}</button></div>
            </if>
        </volist>
        <input type="hidden" id="house_value" value="{$houseList[0]['StockHouseName']}">
	    </div>
        </div>
    </div>
    <div class="mt20 clearfix">
        <div class="col-md-1 title">
            CPU:
        </div>
        <div class="col-md-9">
	    <div id="cpu" class="clearfix">
		<div class="cpu-button"><button class="option cpu btn btn-default btn-info" mem-list="512,1,2,4" data="1"><i class="fa fa-check-circle-o"></i>1核</button></div>
		<div class="cpu-button"><button class="option cpu btn btn-default" mem-list="2,4,8" data="2">2核</button></div>
		<div class="cpu-button"><button class="option cpu btn btn-default" mem-list="4,8,16" data="4">4核</button></div>
		<div class="cpu-button"><button class="option cpu btn btn-default" mem-list="8,16,32" data="8">8核</button></div>
	    </div>
        </div>
        <input type="hidden" id="cpu_value" value="1">
        <if condition="$_SESSION['user'] neq ''"><div class="col-md-2"><h4>账户信息</h4></div></if>
    </div>
    
    <div class="mt20 clearfix">
        <div class="col-md-1 title">
            内存:
        </div>
        <div class="col-md-9">
            <div id="mem" class="clearfix">
		<div><button class="option mem btn btn-default btn-info" data="512"><i class="fa fa-check-circle-o"></i>512MB</button></div>
		<div><button class="option mem btn btn-default" data="1">1GB</button></div>
		<div><button class="option mem btn btn-default" data="2">2GB</button></div>
		<div><button class="option mem btn btn-default" data="4">4GB</button></div>
	    </div>
        </div>
        <input type="hidden" id="mem_value" value="512">             
        <if condition="$_SESSION['user'] neq ''">
        	<div class="col-md-2">余额：¥ <label id="balance" style="color:red;">{$balance|number_format=###,2}</label></div>
            <div class="col-md-2"><a href="javascript:void(0);" onclick="useCoupon();">使用代金券充值</a></div>
        </if>
    </div>
    <div class="mt20 clearfix">        
        <div class="col-md-1 title">
        系统:
        </div>
        <div class="col-md-9">
            <div id="os-version" class="os-btn">
            <div class="btn-group">
	      <button type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown">
		<volist name="osList" id="item">
         	<if condition="$i == 1">
            	<span id="system-name">{$item.SystemName}</span> 
            </if>
         </volist> 
		<span class="caret"></span>
	      </button>
	      <ul class="dropdown-menu image-version-list" role="menu">
          	<volist name="osList" id="item">
            	<li><a href="javascript:void(0);" onclick="verclick(this);" version="{$item.SystemName}">{$item.SystemName}</a></li> 
            </volist>
            <!--li><a href="javascript:void(0);" onclick="verclick(this);" version="6.2 64位">6.2 64位</a></li> 
            <li><a href="javascript:void(0);" onclick="verclick(this);" version="6.3 32位">6.3 32位</a></li> 
            <li><a href="javascript:void(0);" onclick="verclick(this);" version="6.3 64位">6.3 64位</a></li> 
            <li><a href="javascript:void(0);" onclick="verclick(this);" version="6.5 32位">6.5 32位</a></li> 
            <li><a href="javascript:void(0);" onclick="verclick(this);" version="6.5 64位">6.5 64位</a></li--> 
	      </ul>
	    </div>
	    </div>
        </div>        
        <div class="col-md-2"><h4>套餐推荐</h4></div>
    </div>	
	<div class="mt20 clearfix">        
        <div class="col-md-1 title">
        系统盘:
        </div>
        <div class="col-md-9">
        	<span class="zero_tip" style="margin:0;padding:0;color:#f76120">默认赠送50G</span>
        </div>
        <div class="col-md-2"><a href="javascript:void(0);" onclick="setTaocang(this);" data="1,1,100,5" price="185">5M创业型套餐</a></div>
        <div class="col-md-2"><a href="javascript:void(0);" onclick="setTaocang(this);" data="2,4,200,10" price="800">10M升级套餐</a></div>
    </div>
    <div class="mt20 clearfix">
        <div class="col-md-1 title for-slider">数据盘:</div>
        <div class="col-md-9">
            <input id="disk" type="text" value="" data-slider-min="0" data-slider-max="1000" data-slider-step="50" data-slider-value="0" data-slider-tooltip="hide" data-slider-handle="square" >
            <div id="disk-slider-input" style="float: left;"><input id="disk_value" value="0" data-original-title="" title=""><span class="unit">GB</span><span class="zero_tip"></span></div>
        </div>        
        <div class="col-md-2"><h4>实用型套餐</h4></div>
    </div>

    <div class="mt20 clearfix">
        <div class="col-md-1 title for-slider">国际BGP:</div>
        <div class="col-md-9">
	    <input id="net" type="text" value="" data-slider-min="0" data-slider-max="200" data-slider-step="1" data-slider-value="0" data-slider-tooltip="hide" data-slider-handle="square" >
	    <div id="net-slider-input"><input id="net_value" value="0" data-original-title="" title=""><span class="unit">Mbps</span><span class="zero_tip">默认赠送一个IP</span></div>
        </div>        
        <div class="col-md-2"><a href="javascript:void(0);" onclick="setTaocang(this);" data="4,8,500,20" price="2060">20M推荐套餐</a></div>
        <div class="col-md-2"><a href="javascript:void(0);" onclick="setTaocang(this);" data="8,16,800,50" price="5020">50M惊喜套餐</a></div>
    </div>
    
    <div class="mt20 clearfix">
        <div class="col-md-1 title for-slider">国内BGP:</div>
        <div class="col-md-9">
	    <input id="bgp" type="text" value="" data-slider-min="0" data-slider-max="200" data-slider-step="1" data-slider-value="5" data-slider-tooltip="hide" data-slider-handle="square" >
	    <div id="bgp-slider-input"><input id="bgp_value" value="5" data-original-title="" title=""><span class="unit">Mbps</span><span class="zero_tip">默认赠送一个IP</span></div>
        </div>        
    </div>

    <div class="mt20 clearfix">
        <div class="col-md-1 title for-slider">数量:</div>
        <div class="col-md-9">
	    <input id="num" type="text" value="" data-slider-min="1" data-slider-max="20" data-slider-step="1" data-slider-value="1" data-slider-tooltip="hide" data-slider-handle="square" >
	    <div id="q-slider-input"><input id="num_value" value="1" data-original-title="" title=""><span class="unit">台</span><span class="zero_tip"></span></div>
        </div>
    </div>

    <div class="mt20 clearfix">
        
        <div class="col-md-1 title">
            时长:
        </div>
        <div id="term" class="col-md-9">
	    <button class="option term btn btn-info" data="1">月</button>
	    <button class="option term btn btn-default" data="5">半年</button>
	    <button class="option term btn btn-default" data="10">年</button>
	    <span class="zero_tip">优惠：半年付支付5个月，年付只需10个月</span>
	</div>
        
    </div>

    <div class="container">
        <hr>
    </div>
    
    <div class="clearfix">
        <div class="row">
            <div class="col-md-2 hidden-xs"></div>
            <div class="col-md-4">
                <span class="price-text">价格:</span>
                <span id="price" class="money">125.00</span>
            </div>
            <div id="buy-div" class="col-md-6 anonymous"><a href="javascript:void(0);" onClick="order()" id="buy" class="btn btn-info">立即购买</a></div>
        </div>
    </div>

</div>

    <!-- footer start-->
    <div style="clear:both;background: #fff;border-top: 5px solid #0089b7;padding-top:10px;width: 100%;height: 115px;margin-top:40px;"><include file="Public:footer" /></div>
    
    <style>
     .copyright-100{ margin:0 auto;text-align:center;width:1024px;border-top:none;}
     .copyright-100 a{ color:#666;}
	 #house .btn{ margin-top:5px;}
    </style>
	
    <script src="__ROOT__/Public/js/jquery.1.11.min.js" type="text/javascript"></script>
    <script src="__ROOT__/Public/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="__ROOT__/Public/js/bootstrap-slider.js" type="text/javascript"></script>
    <script type="text/javascript" src="__ROOT__/Public/js/layer/layer.min.js"></script>
    <script type="text/javascript">
		var layer_offset_top = "110px";
		$(function(){
			if(window.innerHeight<700){
				layer_offset_top = "0px";
			}
			var cpu = '{$result.CPU}',ram = '{$result.RAM}',disk = '{$result.DISK}',bgp = '{$result.BandWidthBGP}',iplc = '{$result.BandWidthIPLC}',sys = '{$result.OS}',price = '{$result.Price}',time = '{$result.Time}',num = '{$result.Count}',id = '{$result.Order_ID}',house = '{$result.HouseName}';
			if('{$result}'!=""){
				order_layer = $.layer({
					type: 2,
					maxmin: true,
					title: false,
				    closeBtn: [0, false],
					offset: [layer_offset_top,''],
					area: ['650px', '552px'],
					iframe: {src: APP+'/Index/order?type=exist&id=' + id + '&cpu=' + cpu + '&ram=' + ram + '&sys=' + sys + '&disk=' + disk + '&iplc=' + iplc + '&bgp=' + bgp + '&num=' + num + '&time=' + time + '&price=' + price + '&house=' + house}
				});
			}
		});
		var coupon_layer;
		function useCoupon(){
			coupon_layer = $.layer({
				type: 1,
				title: '使用代金券充值',
				area: ['400px', '260px'],
				shift: 'left', //从左动画弹出
				page: {
					html: '<style>.mytab{margin:20px 0px 0px 50px;} input:focus { border-color: #188AD6; }</style><form action="" id="updatePWD" method="post"><table class="mytab"><tr align="center"><td colspan="2" id="uppwd_msg">&nbsp;</td></tr><tr><td>代金券号：</td><td><input id="code" style="color:#333;text-align: left;margin:15px 0px 0px 12px;padding-left: 10px; line-height: 23px; width:220px; height:30px; border: 1px solid #CCC; background: #FFF; vertical-align: middle; border-radius: 3px; -webkit-border-radius: 3px; -moz-border-radius: 3px;" type="text" tabindex="11"/></td></tr><tr><td>代金券密码：</td><td><input type="password" id="password" style="text-align: left;color:#333;margin:15px 0px 0px 12px;padding-left: 10px; line-height: 23px; width:220px; height:30px; border: 1px solid #CCC; background: #FFF; vertical-align: middle; border-radius: 3px; -webkit-border-radius: 3px; -moz-border-radius: 3px;" tabindex="12"/></td><tr><td></td><td><input style="margin:20px 0px 0px 150px;border: none;margin: 10px 0px 10px 12px;background: #0089b7;color: #fff;width: 80px;height: 28px;display: block;text-align: center;line-height: 28px;font-weight: bold;cursor: pointer;float: left;box-shadow: 2px 2px 1px #888888;-moz-box-shadow: 2px 2px 1px #888888;-webkit-box-shadow: 2px 2px 1px #888888;-o-box-shadow: 2px 2px 1px #888888;-moz-border-radius: 3px;-o-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;" type="button" value="下一步" onClick="nextOpt()"/></td></tr></table></form>'
				}
			});
		}
		var use_layer;
		function nextOpt(){
			var code = $("#code").val(),pwd = $("#password").val();
			if(!code){
				$("#code").focus();
				return false;
			}
			if(!pwd){
				$("#password").focus();
				return false;
			}
			$.ajax({
				url:'__APP__/Index/selectCoupon',
				type:'post',
				async:false,
				data:{'code':code,'pwd':pwd},
				success:function(data){
					if(data.info=="success"){
						layer.close(coupon_layer);
						use_layer = $.layer({
							type: 1,
							area: ['430px', '260px'],
							title:false,
							page: {
								html: '<style>.mytab{margin:20px 0px 0px 60px;}.mytab tr{height:30px;}.couponInput{margin:15px 0px 0px 12px;padding-left: 10px; line-height: 23px; width:200px; height:30px; border: 1px solid #CCC; background: #FFF; vertical-align: middle; border-radius: 3px; -webkit-border-radius: 3px; -moz-border-radius: 3px;} input:focus { border-color: #188AD6; }</style><h3 style="margin:20px 0px 0px 30px;">使用代金券充值</h3><form action="" id="updatePWD" method="post"><table class="mytab"><tr align="center"><td colspan="2" id="uppwd_msg">&nbsp;</td></tr><tr><td width="120">代金券号：</td><td>'+data.data.Code+'</td></tr><tr><td width="120">代金券金额：</td><td>¥ <label style="color:red">'+data.data.Money+'</label></td><tr><td></td><td><input style="border: none;margin: 10px 0px 10px 12px;background: #0089b7;color: #fff;width: 80px;height: 28px;display: block;text-align: center;line-height: 28px;font-weight: bold;cursor: pointer;float: left;box-shadow: 2px 2px 1px #888888;-moz-box-shadow: 2px 2px 1px #888888;-webkit-box-shadow: 2px 2px 1px #888888;-o-box-shadow: 2px 2px 1px #888888;-moz-border-radius: 3px;-o-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;" type="button" value="确定使用" onClick="updateCoupon('+data.data.ID+','+data.data.Money+')"/></td></tr></table></form>'
							}
						});
					}else{
						layer.msg(data.data,3,3);	
					}
				},
				error:function(data){
					layer.msg(data.statusText,3,3);
				}				
			});
		}
		function updateCoupon(id,money){
			$.ajax({
				url:'__APP__/Index/updateCoupon',
				type:'post',
				async:false,
				data:{'id':id},
				success:function(data){
					if(data.info=='success'){
						layer.close(use_layer);
						$("#balance").html(data.data);
					}
				},
				error:function(data){
					layer.msg(data.statusText,3,3);
				}
			});
		}
		var USER = "{$_SESSION['user']}",send_layer;
    	function order(){
			var cpu = "",ram="", sys = $("#system-name").html(),house = $("#house_value").val(),disk=$("#disk_value").val(),iplc=$("#net_value").val(),bgp=$("#bgp_value").val(),num=$("#num_value").val(),time="",price=$("#price").html();
			$("#cpu button").each(function(){
				if($(this).attr("class").indexOf("btn-info")!=-1){
					cpu = $(this).text();	
				}
			});
			$("#mem button").each(function(){
				if($(this).attr("class").indexOf("btn-info")!=-1){
					ram = $(this).text();	
				}
			});
			$("#term button").each(function(){
				if($(this).attr("class").indexOf("btn-info")!=-1){
					time = $(this).text();	
				}
			});
			
			if(USER==''){
				$.layer({
					type: 2,
					maxmin: true,
					title: '您还尚未登录',
					offset: ['110px',''],
					area: ['500px', '402px'],
					iframe: {src: APP+'/Index/login_div'}
				}); 
			}else{
				var is_buy = false,is_null = false;
				$.ajax({
					url:'__APP__/Index/checkUserInfo',
					type:'post',
					async:false,
					success:function(data){
						if(data.data==1){
							is_null = true;
						}
					},
					error:function(data){
						layer.msg('温馨提示：'+data.statusText,2,3);
					}
				});
				if(!is_null){
					layer.msg('请填写完整的用户信息。',3,3)	;
					setInterval(function (){
						window.location.href="__APP__/Index/account";
					},3000);
					return false;
				}
				$.ajax({
					url:'__APP__/Index/checkAudit',
					type:'post',
					async:false,
					success:function(data){
						if(data.data==1){
							is_buy = true;
						}
					},
					error:function(data){
						layer.msg('温馨提示：'+data.statusText,2,3);
					}
				});
				if(!is_buy){
					send_layer = $.layer({
						type: 1,
						title: false,
						area: ['auto', 'auto'],
						page: {
							html: '<div style="width:270px;height:73px;"><span class="xubox_msg xulayer_png32 xubox_msgico xubox_msgtype7" style="top: 22px;"></span><label style="margin:20px 0px 0px 70px;">请在邮箱激活账户购买资格。</label><br/><label style="margin:0px 0px 0px 70px;">邮箱没有收到邮件？<a href="javascript:void(0);" onClick="sendMail()">再次发送</a></label></div>'
						}
					});
					return false;	
				}
				order_layer = $.layer({
					type: 2,
					maxmin: true,
					title: false,
				    closeBtn: [0, false],
					offset: [layer_offset_top,''],
					area: ['650px', '552px'],
					iframe: {src: APP+'/Index/order?cpu=' + cpu + '&ram=' + ram + '&sys=' + sys + '&disk=' + disk + '&iplc=' + iplc + '&bgp=' + bgp + '&num=' + num + '&time=' + time + '&price=' + price + '&house=' + house}
				}); 
			}
		}
		function sendMail(){
			layer.close(send_layer);
			layer.load('请在邮箱激活!');
			$.ajax({
				url:'__APP__/Index/sendMail',
				type:'post',
				async:false,
				success:function(data){
					if(data.info=="error"){
						layer.msg('温馨提示：'+data.data,2,3);	
					}
				},
				error:function(data){
					layer.msg('温馨提示：'+data.statusText,2,3);
				}
			});
			_interval = setInterval(function (){checkBuy();},3000);
		}
		function checkBuy(){
			$.ajax({
				url:'__APP__/Index/checkAudit',
				type:'post',
				async:false,
				success:function(data){
					if(data.data==1){
						clearInterval(_interval);
						window.top.location.reload();
					}
				},
				error:function(data){
					layer.msg('温馨提示：'+data.statusText,2,3);
				}
			});
		}
     var r,b,g,n;
     (function() {
	  //选择机房
	  $(".house-button").find("button").click(function(){
		if($(this).hasClass("btn-info"))return false;
	      var old = $(this).html();
	      var val = $(this).attr("data");
	      $('#house_value').val(val);
	      $(".house-button").find("i").remove(".fa");
	      $(".house-button").find("button").removeClass("btn-info").addClass("btn-default");
	      $(this).removeClass("btn-default").addClass("btn-info");
	      $(this).html('<i class="fa fa-check-circle-o"></i>' + old);
		  
	   });
	  //选择CPU
	  $(".cpu-button").find("button").click(function(){
	      if($(this).hasClass("btn-info"))return false;
	      var old = $(this).html();
	      var val = $(this).attr("data");
	      $('#cpu_value').val(val);
	      $(".cpu-button").find("i").remove(".fa");
	      $(".cpu-button").find("button").removeClass("btn-info").addClass("btn-default");
	      $(this).removeClass("btn-default").addClass("btn-info");
	      $(this).html('<i class="fa fa-check-circle-o"></i>' + old);
	      
	      var str = $(this).attr("mem-list");
	      var arr = str.split(",");
	      $("#mem").empty();
	      for(var i = 0; i < arr.length; i++){
		    if(i==0){
			if(arr[i] >= 512){
			      $("#mem").append('<div><button id="mem_'+arr[i]+'" class="option mem btn btn-default btn-info" data="'+arr[i]+'"><i class="fa fa-check-circle-o"></i>'+arr[i]+'MB</button></div>');
			      $('#mem_value').val(arr[i]);
			      
			}else{
			      $("#mem").append('<div><button id="mem_'+arr[i]+'" class="option mem btn btn-default btn-info" data="'+arr[i]+'"><i class="fa fa-check-circle-o"></i>'+arr[i]+'GB</button></div>');
			      $('#mem_value').val(arr[i]);
			}
		    }else{
			$("#mem").append('<div><button id="mem_'+arr[i]+'" class="option mem btn btn-default" data="'+arr[i]+'">'+arr[i]+'GB</button></div>');
		    }
		    $("#mem_"+arr[i]).bind("click",function(){memclick(this)});
	      }
	      
	      checkPrice();
	  });
	  
	  //选择内存
	  $("#mem").find("button").click(function(){memclick(this)});
	  //选择时间
	  $("#term").find("button").click(function(){termclick(this)});

	  var diskChange = function() {
		//console.log(r.getValue());
		$('#disk_value').val(r.getValue());
		
		checkPrice();
	  };
	  
	  var netChange = function() {
		$('#net_value').val(b.getValue());
		g.setValue(0);
		$('#bgp_value').val(0);
		
		checkPrice();
	  };
	  
	  var bgpChange = function() {
		$('#bgp_value').val(g.getValue());
		b.setValue(0);
		$('#net_value').val(0);
		
		checkPrice();
	  };
	  
	  var numChange = function() {
		$('#num_value').val(n.getValue());
		$('#price_num').val(n.getValue());
		var p = parseInt($('#price_total').val());
		//alert(p);
		$('#price').html(p * n.getValue() + ".00");
	  };
	  
	  r = $('#disk').slider().on('slide', diskChange).data('slider');
          r.setValue(0);
	  
	  g = $('#bgp').slider().on('slide', bgpChange).data('slider');
	  	  
	  b = $('#net').slider().on('slide', netChange).data('slider');
          b.setValue(0);
          
	  n = $('#num').slider().on('slide', numChange).data('slider');

	  $(".slider.slider-horizontal").attr("style","width: 395px; float: left; margin-left: 11px;");
	  
	  $("#disk_value").blur(function(){
		var val = $(this).val();
		if($.isNumeric(val)){
			if(parseInt(val) > 1000){
			      $(this).val(1000);
			      r.setValue(1000);
			}else{
			      if(parseInt(val) % 50 == 0){
				    $(this).val(val);
				    r.setValue(val);
			      }else{
				    var set = 50 - (parseInt(val) % 50) + parseInt(val);
				    $(this).val(set);
				    r.setValue(set);
			      }
			}
			$('#buy').removeAttr('disabled'); 
			checkPrice();
		}else{
			$('#buy').attr('disabled','disabled');
		}
	  });
	  
	  $("#net_value").blur(function(){
		var val = $(this).val();
		if($.isNumeric(val)){
			if(parseInt(val) > 200){
			      $(this).val(200);
			      b.setValue(200);
			}else{
			      b.setValue(val);
			}
			g.setValue(0);
			$("#bgp_value").val(0);
			$('#buy').removeAttr('disabled'); 
			checkPrice();
		}else{
			$('#buy').attr('disabled','disabled');
		}
	  });
	  
	  $("#bgp_value").blur(function(){
		var val = $(this).val();
		if($.isNumeric(val)){
			if(parseInt(val) > 200){
			      $(this).val(200);
			      g.setValue(200);
			}else{
			      g.setValue(val);
			}
			b.setValue(0);
			$("#net_value").val(0);
			$('#buy').removeAttr('disabled'); 
			checkPrice();
		}else{
			$('#buy').attr('disabled','disabled');
		}
	  });
	  
	  $("#num_value").blur(function(){
		var val = $(this).val();
		if($.isNumeric(val)){
			if(parseInt(val) > 20){
			      n.setValue(20);
			      $(this).val(20);
			      $('#price_num').val(20);
			}else{
			      n.setValue(val);
			      $(this).val(val);
			      $('#price_num').val(val);
			}
			$('#buy').removeAttr('disabled'); 
			checkPrice();
		}else{
			$('#buy').attr('disabled','disabled');
		}
	  });
     })();
     
     function osclick(evt){
		var os = $(evt).attr("name");
		/*if(os == "CentOS"){
			$('#version-no').html("6.2 32位");
			$(".image-version-list").empty();
			$(".image-version-list").append('<li><a href="javascript:void(0);" onclick="verclick(this);" version="6.2 32位">6.2 32位</a></li> ');
			$(".image-version-list").append('<li><a href="javascript:void(0);" onclick="verclick(this);" version="6.2 64位">6.2 64位</a></li> ');
			$(".image-version-list").append('<li><a href="javascript:void(0);" onclick="verclick(this);" version="6.3 32位">6.3 32位</a></li> ');
			$(".image-version-list").append('<li><a href="javascript:void(0);" onclick="verclick(this);" version="6.3 64位">6.3 64位</a></li> ');
			$(".image-version-list").append('<li><a href="javascript:void(0);" onclick="verclick(this);" version="6.5 32位">6.5 32位</a></li> ');
			$(".image-version-list").append('<li><a href="javascript:void(0);" onclick="verclick(this);" version="6.5 64位">6.5 64位</a></li> ');
		}
		if(os == "Windows Server"){
			$('#version-no').html("2003 64位");
			$(".image-version-list").empty();
			//$(".image-version-list").append('<li><a href="javascript:void(0);" onclick="verclick(this);" version="2003 32位">2003 32位</a></li> ');
			$(".image-version-list").append('<li><a href="javascript:void(0);" onclick="verclick(this);" version="2003 64位">2003 64位</a></li> ');
			//$(".image-version-list").append('<li><a href="javascript:void(0);" onclick="verclick(this);" version="2008 32位">2008 32位</a></li> ');
			$(".image-version-list").append('<li><a href="javascript:void(0);" onclick="verclick(this);" version="2008 64位">2008 64位</a></li> ');
		}*/
		$('#house-name').html(os);
	  }
     function verclick(evt){
	  $('#system-name').html($(evt).attr("version"));
     }
	  
     function memclick(evt){
	      if($(evt).hasClass("btn-info"))return false;
	      var old = $(evt).html();
	      var val = $(evt).attr("data");
	      $('#mem_value').val(val);
	      $("#mem").find("i").remove(".fa");
	      $("#mem").find("button").removeClass("btn-info").addClass("btn-default");
	      $(evt).removeClass("btn-default").addClass("btn-info");
	      $(evt).html('<i class="fa fa-check-circle-o"></i>' + old);
	      //console.log($(evt).attr("data"));
	      
	      checkPrice();
      }
      
     function termclick(evt){
	      if($(evt).hasClass("btn-info"))return false;
	      $("#term").find("button").removeClass("btn-info").addClass("btn-default");
	      $(evt).removeClass("btn-default").addClass("btn-info");
	      var term = parseInt($(evt).attr("data"));
	      $('#price_term').val(term);
	      var p = parseInt($('#price_total').val());
	      $('#price').html(p * term + ".00");
	      
	      checkPrice();
      }
	  
     function setTaocang(evt){
	  var data = $(evt).attr("data");
	  var price = $(evt).attr("price");
	  var arr = data.split(",");
	  
	  $("#term").find("button").removeClass("btn-info").addClass("btn-default");
	  $("#term button:eq(0)").addClass("btn-info");
	  g.setValue(arr[3]);
	  b.setValue(0);
	  $('#bgp_value').val(arr[3]);
	  $('#net_value').val(0);
	  
	  r.setValue(arr[2]);
	  $('#disk_value').val(arr[2]);
	  
	  setCpu(arr[0]);
	  $('#cpu_value').val(arr[0]);
	  setMem(arr[1]);
	  $('#mem_value').val(arr[1]);
	  
	  $('#price').html(price + ".00");
	  $('#price_total').val(price);
     }
     
     function setCpu(val){
	  $(".cpu-button").find("i").remove(".fa");
	  $(".cpu-button").find("button").removeClass("btn-info").addClass("btn-default");
	  $(".cpu-button").find("button").each(function(){
	      var old = $(this).html();
	      if($(this).attr("data") == val){
		  if($(this).hasClass("btn-info"))return false;
		  $(this).removeClass("btn-default").addClass("btn-info");
		  $(this).html('<i class="fa fa-check-circle-o"></i>' + old);
		  $('#cpu_value').val(val);
	      }
	  });
	  
	  var str = "";
	  if(val == 1){
	      str = $($("#cpu").find("button").get(0)).attr("mem-list");
	  }
	  if(val == 2){
	      str = $($("#cpu").find("button").get(1)).attr("mem-list");
	  }
	  if(val == 4){
	      str = $($("#cpu").find("button").get(2)).attr("mem-list");
	  }
	  if(val == 8){
	      str = $($("#cpu").find("button").get(3)).attr("mem-list");
	  }
	  var arr = str.split(",");
	  $("#mem").empty();
	  for(var i = 0; i < arr.length; i++){
		if(i==0){
			if(arr[i]>=512){
				$("#mem").append('<div><button id="mem_'+arr[i]+'" class="option mem btn btn-default btn-info" data="'+arr[i]+'"><i class="fa fa-check-circle-o"></i>'+arr[i]+'MB</button></div>');
				$('#mem_value').val(arr[i]);
				
			}else{
				$("#mem").append('<div><button id="mem_'+arr[i]+'" class="option mem btn btn-default btn-info" data="'+arr[i]+'"><i class="fa fa-check-circle-o"></i>'+arr[i]+'GB</button></div>');
				$('#mem_value').val(arr[i]);
			}			
		}else{
			if(arr[i]>=512){
				$("#mem").append('<div><button id="mem_'+arr[i]+'" class="option mem btn btn-default" data="'+arr[i]+'">'+arr[i]+'MB</button></div>');
			}else{				
				$("#mem").append('<div><button id="mem_'+arr[i]+'" class="option mem btn btn-default" data="'+arr[i]+'">'+arr[i]+'GB</button></div>');
			}
		}
		$("#mem_"+arr[i]).bind("click",function(){memclick(this)});
	  }
     }
     
     function setMem(val){
	  $("#mem").find("i").remove(".fa");
	  $("#mem").find("button").removeClass("btn-info").addClass("btn-default");
	  $("#mem").find("button").each(function(){
	      var old = $(this).html();
	      if($(this).attr("data") == val){
		  if($(this).hasClass("btn-info"))return false;
		  $(this).removeClass("btn-default").addClass("btn-info");
		  $(this).html('<i class="fa fa-check-circle-o"></i>' + old);
		  $('#mem_value').val(val);
	      }
	  });
     }
     
     function checkPrice(){
		var cpu = $('#cpu_value').val();
		var mem = $('#mem_value').val();
		var disk = $('#disk_value').val();
		var bgp = $('#bgp_value').val();
		var net = $('#net_value').val();
		var sum = returnPrice(cpu, mem, disk, bgp, net);
		
		$('#price_total').val(sum);
		var term = parseInt($('#price_term').val());
		var num = parseInt($('#price_num').val());
		var p = parseInt($('#price_total').val());
		$('#price').html(p * term * num + ".00");
	  
	  /*$.ajax({
		url: '__APP__/Index/checkPrice',
		type: "get",
		data:{ cpu:cpu, ram: mem, disk: disk, bgp: bgp, iplc: net },
		success: function (data) {
			$('#price_total').val(data.data);
			
			var term = parseInt($('#price_term').val());
			var num = parseInt($('#price_num').val());
			var p = parseInt($('#price_total').val());
			$('#price').html(p * term * num + ".00");
		},
		error: function (data) {
			alert(data.statusText);
		}
	  });*/
	  
     }
	 function returnPrice(_cpu, _mem,_disk,_bgp,_net){
		var cpu = new Array(),ram = new Array(),bgp = new Array(),iplc = new Array(),sum=0,price_disk=0,price_bgp=0,price_iplc=0;
		
		disk = 20;
		
		cpu[1] = 5;
		cpu[2] = 110;			
		cpu[4] = 240;			
		cpu[8] = 500;
		
		ram[512] = 20;
		ram[1] = 40;
		ram[2] = 85;
		ram[4] = 110;
		ram[8] = 220;
		ram[16] = 450;
		ram[32] = 950;
		
		bgp[0] = [0,5,20];
		bgp[1] = [5,10,50];
		bgp[2] = [10,30,70];
		bgp[3] = [30,50,75];
		bgp[4] = [50,100,75];
		bgp[5] = [100,200,80];
		
		iplc[0]= [0,2,400];
		iplc[1]= [2,5,550];
		iplc[2]= [5,10,500];
		iplc[3]= [10,50,400];
		iplc[4]= [50,999999,360];
		
		price_disk = _disk / 50 * disk;
		
		for(var i=0;i<bgp.length;i++){
			if(_bgp >= bgp[i][0] && _bgp <= bgp[i][1]){
				price_bgp = _bgp * bgp[i][2];
				break;
			}
       	}
		for(var i=0;i<iplc.length;i++){
			if(_net >= iplc[i][0] && _net <= iplc[i][1]){
				price_iplc = _net * iplc[i][2];
				break;
			}
       	}
		
		sum = price_disk + price_bgp + price_iplc + cpu[_cpu] + ram[_mem]
		return sum;	
	}
    </script>
</body>
</html>
